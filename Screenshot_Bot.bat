@echo off
title Screenshot Bot - 4pm, 5pm, 6pm, 7pm
powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "Add-Type @'`nusing System;`nusing System.Runtime.InteropServices;`npublic class DPI {`n[DllImport(\"user32.dll\")]`npublic static extern bool SetProcessDPIAware();`n}`n'@; [DPI]::SetProcessDPIAware(); Add-Type -A System.Windows.Forms,System.Drawing; $t=@('16:00','17:00','18:00','19:00'); $p='C:\Screenshots'; Write-Host 'Screenshot Bot Started - 4pm,5pm,6pm,7pm' -F Green; while($true){$n=Get-Date -F HH:mm; if($t -contains $n){md $p -Force|Out-Null; $m=[System.Windows.Forms.Screen]::AllScreens; $s=if($m.Count -gt 1){$m[1]}else{$m[0]}; $b=$s.Bounds; $bmp=New-Object System.Drawing.Bitmap $b.Width,$b.Height; $g=[System.Drawing.Graphics]::FromImage($bmp); $g.CopyFromScreen($b.X,$b.Y,0,0,$bmp.Size); $bmp.Save(\"$p\screenshot_$(Get-Date -F yyyyMMdd_HHmmss).png\"); $g.Dispose(); $bmp.Dispose(); Write-Host \"Screenshot saved at $(Get-Date)\" -F Green; Start-Sleep 61} Start-Sleep 30}"